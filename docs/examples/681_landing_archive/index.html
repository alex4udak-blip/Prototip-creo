<!DOCTYPE html>
<html lang="de">
<head>
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=0.9, maximum-scale=0.9, minimum-scale=0.9, viewport-fit=cover">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="theme-color" content="#FFFFFF">
    <meta name="google" value="notranslate">
    <title>ICE FISHING DE</title>
    <link rel="apple-touch-icon" sizes="180x180" href="assets/iceFishing/img/apple-touch-icon.webp">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/iceFishing/img/favicon-32x32.webp">
    <link href="assets/iceFishing/css/style.css" rel="stylesheet">
    <style>
        body { font-family: 'Open Sans', sans-serif; font-weight: 800; }
        .loader { background: linear-gradient(177deg, #E0F0FF 7.71%, #ABD6FF 77.17%); }
        .loader__logo { max-width: 400px !important; margin-bottom: 20px !important; }
        @media (max-width: 767px) { .loader__logo { margin-top: -25% !important; max-width: 300px !important; } }
        .loader__progress-line { background: #60BDFF; }
        .loader__progress::before { background: #33434E !important; }
        .loader__progress { background: #33434E; }
        .loader { position: fixed; top: 0; left: 0; right: 0; bottom: 0; justify-content: center; align-items: center; flex-direction: column; z-index: 999; width: 100%; height: 100vh; padding: 15px; display: flex; }
        .loader.is--loaded { display: none; }
        .loader__logo { margin-bottom: 35px; width: 100%; max-width: 400px; }
        .loader__progress { width: 100%; height: 28px; max-width: 340px; padding: 4px; border-radius: 100px; position: relative; }
        .loader__progress::before { position: absolute; content: ''; left: 4px; top: 4px; border-radius: 100px; width: calc(100% - 8px); height: calc(100% - 8px); background-color: #fff; }
        .loader__progress-line { position: relative; z-index: 2; width: 0; height: 100%; border-radius: 100px; transition: width 0.5s ease; }
        @media (max-width: 767px) { .loader__progress { max-width: 220px; } }
        .dev-mode { display: none !important; }
    </style>
</head>
<body>
<div class="loader">
    <img class="loader__logo" src="assets/iceFishing/img/logo.webp" alt="logo">
    <div class="loader__progress">
        <div class="loader__progress-line"></div>
    </div>
</div>

<div class="body-wrapper">
    <div class="game" id="game" data-rate="100" data-spins="1">
        <!-- START SCREEN -->
        <div class="game-start" id="game-start">
            <img class="game-start__logo" src="assets/iceFishing/img/logo.webp" alt="">
            <div class="game-start__button">
                <button class="bottom__section-button pulse" id="go-btn">
                    <span class="bottom__section-button-default" id="go-btn-default-text">Spielen</span>
                    <span class="bottom__section-button-next" id="go-btn-next-text">_</span>
                </button>
            </div>
        </div>

        <!-- GAME FIELD WITH WHEEL -->
        <div class="game-field" id="game-field">
            <div class="game-wheel" id="game-wheel">
                <div class="game-wheel__btn"></div>
                <div class="game-wheel__arrow"></div>
                <div class="game-wheel__frame"></div>
                <div class="game-wheel__spin">
                    <div class="game-wheel__ring"></div>
                    <div class="game-wheel__sectors"></div>
                </div>
            </div>
            <div class="game-person">
                <img class="game-person__img" src="assets/iceFishing/img/left-person.webp" alt="">
            </div>
        </div>

        <!-- ANIMATION SCREEN -->
        <div class="game-animation" id="game-animation">
            <div class="game-animation__loader"></div>
            <div class="game-animation__aqua">
                <video autoplay loop muted playsinline id="game-video">
                    <source src="assets/iceFishing/img/fishes-1.webm" type="video/webm">
                </video>
            </div>
            <div class="game-animation__land">
                <div class="game-animation__wrapper">
                    <div class="game-animation__crane"></div>
                    <div class="game-animation__helicopter"></div>
                    <div class="game-animation__ice"></div>
                    <div class="game-animation__fish">
                        <img src="assets/iceFishing/img/orange-fish-vertical.gif" alt="">
                    </div>
                </div>
            </div>
            <div class="game-controls-balance">
                <div class="game-controls-balance__container">
                    <div class="game-controls-balance__item">
                        <div class="game-controls-balance__item-label">BALANCE</div>
                        <div class="game-controls-balance__item-value"><span>100</span>€</div>
                    </div>
                    <div class="game-controls-balance__item is--cells">
                        <div class="game-controls-balance__item-label">TOTAL BET</div>
                        <div class="game-controls-balance__item-value"><span>100</span>€</div>
                    </div>
                </div>
            </div>
            <div class="game-controls-fishes__middle-item is--orange">
                <img src="assets/iceFishing/img/orange-fish-preview.webp" alt="orange fish">
                <div class="game-controls-fishes__middle-item-title"><span>BIG<br/> ORANGES</span></div>
                <div class="game-controls-fishes__middle-item-bonus"><span>BONUS</span></div>
            </div>
        </div>

        <!-- CONTROLS -->
        <div class="game-controls" id="game-controls">
            <div class="game-controls__container">
                <div class="game-controls-preview">
                    <div class="game-controls-preview__container">
                        <div class="game-controls-preview__fish"><span>?</span></div>
                    </div>
                </div>
                <div class="game-controls-balance">
                    <div class="game-controls-balance__container">
                        <div class="game-controls-balance__item">
                            <div class="game-controls-balance__item-label">BALANCE</div>
                            <div class="game-controls-balance__item-value"><span>100</span>€</div>
                        </div>
                        <div class="game-controls-balance__item is--cells">
                            <div class="game-controls-balance__item-label">TOTAL BET</div>
                            <div class="game-controls-balance__item-value"><span>100</span>€</div>
                        </div>
                    </div>
                </div>
                <div class="game-controls-fishes">
                    <div class="game-controls-fishes__container">
                        <div class="game-controls-fishes__left">
                            <div class="game-controls-fishes__left-item is--top">
                                <div class="game-controls-fishes__left-item-bet"><span>1</span></div>
                            </div>
                            <div class="game-controls-fishes__left-item is--bottom"></div>
                        </div>
                        <div class="game-controls-fishes__middle">
                            <div class="game-controls-fishes__middle-item is--blue">
                                <img src="assets/iceFishing/img/blue-fish-preview.webp" alt="blue fish">
                                <div class="game-controls-fishes__middle-item-title"><span>LIL`<br/> BlUES</span></div>
                                <div class="game-controls-fishes__middle-item-bonus"><span>BONUS</span></div>
                            </div>
                            <div class="game-controls-fishes__middle-item is--orange">
                                <img src="assets/iceFishing/img/orange-fish-preview.webp" alt="orange fish">
                                <div class="game-controls-fishes__middle-item-title"><span>BIG<br/> ORANGES</span></div>
                                <div class="game-controls-fishes__middle-item-bonus"><span>BONUS</span></div>
                            </div>
                            <div class="game-controls-fishes__middle-item is--red">
                                <img src="assets/iceFishing/img/red-fish-preview.webp" alt="red fish">
                                <div class="game-controls-fishes__middle-item-title"><span>HUGE<br/> REDS</span></div>
                                <div class="game-controls-fishes__middle-item-bonus"><span>BONUS</span></div>
                            </div>
                        </div>
                        <div class="game-controls-fishes__right">
                            <div class="game-controls-fishes__right-item"><span>ALL RESOURCES</span></div>
                        </div>
                    </div>
                </div>
                <div class="game-controls-bet">
                    <div class="game-controls-bet__button">
                        <button class="bottom__section-button" id="spin-btn">
                            <span class="bottom__section-button-default" id="spin-btn-default-text">Spielen</span>
                            <span class="bottom__section-button-next" id="spin-btn-next-text">_</span>
                        </button>
                    </div>
                </div>
                <div class="game-controls-graph">
                    <div class="game-controls-graph__container">
                        <span class="game-controls-graph__item is--1"></span>
                        <span class="game-controls-graph__item is--2"></span>
                        <span class="game-controls-graph__item is--3 is--blue"></span>
                        <span class="game-controls-graph__item is--4"></span>
                        <span class="game-controls-graph__item is--5 is--blue-fish"></span>
                        <span class="game-controls-graph__item is--6 is--blue"></span>
                        <span class="game-controls-graph__item is--7"></span>
                        <span class="game-controls-graph__item is--8 is--blue"></span>
                        <span class="game-controls-graph__item is--9"></span>
                        <span class="game-controls-graph__item is--10"></span>
                        <span class="game-controls-graph__item is--11"></span>
                        <span class="game-controls-graph__item is--12 is--blue"></span>
                        <span class="game-controls-graph__item is--13"></span>
                        <span class="game-controls-graph__item is--14 is--blue"></span>
                        <span class="game-controls-graph__item is--15 is--blue"></span>
                        <span class="game-controls-graph__item is--16"></span>
                        <span class="game-controls-graph__item is--17"></span>
                        <span class="game-controls-graph__item is--18"></span>
                        <span class="game-controls-graph__item is--19"></span>
                        <span class="game-controls-graph__item is--20 is--blue"></span>
                        <span class="game-controls-graph__item is--21"></span>
                        <span class="game-controls-graph__item is--22 is--blue"></span>
                        <span class="game-controls-graph__item is--23 is--blue"></span>
                        <span class="game-controls-graph__item is--24"></span>
                        <span class="game-controls-graph__item is--25 is--blue"></span>
                        <span class="game-controls-graph__item is--26"></span>
                        <span class="game-controls-graph__item is--27 is--blue"></span>
                        <span class="game-controls-graph__item is--28"></span>
                        <span class="game-controls-graph__item is--29 is--blue"></span>
                        <span class="game-controls-graph__item is--30 is--blue"></span>
                        <span class="game-controls-graph__item is--31 is--orange-fish"></span>
                        <span class="game-controls-graph__item is--32 is--blue"></span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- WIN MODAL -->
    <div class="modal" id="modal">
        <div class="modal__wrapper">
            <div class="effect">
                <div class="effect__sparkles is--1"></div>
                <div class="effect__sparkles is--2"></div>
                <div class="effect__sparkles is--3"></div>
            </div>
            <div class="modal__content">
                <div class="modal__badge"><span>300x</span></div>
                <div class="modal__fish">
                    <img src="assets/iceFishing/img/orange-fish.webp" alt="">
                </div>
                <div class="modal__title"><span>Herzlichen Glückwunsch!</span></div>
                <div class="modal__text"><span>Gewinn: 1500€</span></div>
            </div>
            <div class="modal__win-btn">
                <button id="win-button-modal" class="bottom__section-button">
                    <span>Abholen</span>
                </button>
            </div>
        </div>
    </div>

    <!-- EFFECTS -->
    <div class="effects hidden" id="effects">
        <img loading="lazy" class="effects__image hidden" id="effects-image" 
             src="assets/general/images/effects/desctop_light_boom.gif" alt="red_flare">
    </div>
</div>

<script>
// =====================================================
// CONFIGURATION - ИЗМЕНИ ССЫЛКУ НА ОФФЕР ЗДЕСЬ (строка 3)
// =====================================================
const CONFIG = {
    offerUrl: 'https://casinobets1.com/wZppRBf3',  // <-- ЗАМЕНИ ЭТУ ССЫЛКУ
    useSound: true,
    stepTime: 3000
};
// =====================================================

class IceFishingGame {
    constructor() {
        this.startButton = document.getElementById('go-btn');
        this.spinButton = document.getElementById('spin-btn');
        this.game = document.getElementById('game');
        this.field = document.getElementById('game-field');
        this.wheel = document.getElementById('game-wheel');
        this.winButton = document.getElementById('win-button-modal');
        this.modal = document.getElementById('modal');
        this.controls = document.getElementById('game-controls');
        this.effectsContainer = document.getElementById('effects');
        this.effectsImage = document.getElementById('effects-image');
        
        this.spinSound = new Audio('assets/general/sound/wheel-spin-click-slow-down-101152.mp3');
        this.winSound = new Audio('assets/general/sound/you-win-sequence-1-183948.mp3');
        this.winSound2 = new Audio('assets/general/sound/winSound/1.mp3');
        
        this.stepTime = CONFIG.stepTime;
        this.isUseSound = CONFIG.useSound;
        this.audioUnlocked = false;
    }

    init() {
        this.startButton.addEventListener('click', () => this.startGame());
        this.winButton.addEventListener('click', () => this.claimPrize());
    }

    // Разблокировка аудио на мобильных при первом клике
    unlockAudio() {
        if (this.audioUnlocked) return;
        
        // Проигрываем и сразу ставим на паузу — это разблокирует аудио
        [this.spinSound, this.winSound, this.winSound2].forEach(sound => {
            sound.muted = true;
            sound.play().then(() => {
                sound.pause();
                sound.currentTime = 0;
                sound.muted = false;
            }).catch(() => {});
        });
        
        this.audioUnlocked = true;
    }

    startGame() {
        this.game.classList.add('is--started');
        this.spinButton.addEventListener('click', () => this.spin());
    }

    spin() {
        this.unlockAudio();  // Разблокируем аудио при клике
        this.spinWheel();
        this.playSound(this.spinSound);
        this.disableControls(this.stepTime);
        this.handleWin();
    }

    spinWheel() {
        this.wheel.classList.add('is--spin-win');
    }

    handleWin() {
        this.disableControls();
        setTimeout(() => {
            this.playSound(this.winSound);
            this.game.classList.add('is--win');
            
            setTimeout(() => {
                this.game.classList.add('is--animation-step-1');
                
                setTimeout(() => {
                    this.game.classList.add('is--animation-step-2');
                    
                    setTimeout(() => {
                        this.game.classList.add('is--animation-step-3');
                        
                        setTimeout(() => {
                            this.showEffects();
                            this.showModal();
                            this.playSound(this.winSound2);
                        }, 7000);
                    }, 2000);
                }, 1500);
            }, 2000);
        }, this.stepTime);
    }

    disableControls(time = null) {
        this.game.classList.add('is--disabled');
        if (time) {
            setTimeout(() => {
                this.game.classList.remove('is--disabled');
            }, time);
        }
    }

    showEffects() {
        this.effectsContainer.classList.add('visible');
        this.effectsContainer.classList.remove('hidden');
        
        setTimeout(() => {
            const block = document.createElement('div');
            block.style.backgroundImage = `url(${this.effectsImage.src})`;
            block.classList.add('effects__block');
            this.effectsContainer.appendChild(block);
            
            setTimeout(() => {
                this.effectsContainer.classList.remove('visible');
                this.effectsContainer.classList.add('hidden');
            }, 1500);
        }, 0);
    }

    showModal() {
        document.body.classList.add('is--modal-open');
        this.modal.classList.add('is--active');
    }

    playSound(sound, delay = 0, volume = 1) {
        if (!this.isUseSound) return;
        setTimeout(() => {
            sound.muted = false;
            sound.currentTime = 0;
            sound.volume = volume;
            sound.play().catch(e => console.log('Audio error:', e));
        }, delay);
    }

    claimPrize() {
        if (navigator.vibrate) navigator.vibrate([40, 20, 40]);
        const urlParams = window.location.search || '';
        const url = CONFIG.offerUrl;
        
        if (url && url !== 'https://YOUR_OFFER_URL') {
            window.location.href = url + urlParams;
        } else {
            alert('Установите ссылку на оффер в CONFIG.offerUrl');
        }
    }
}

// Loader
let progressInterval = null;
const progressLine = document.querySelector('.loader__progress-line');
const loader = document.querySelector('.loader');

function increaseLoaderProgress() {
    let width = 0;
    progressInterval = setInterval(() => {
        if (width >= 99) {
            progressLine.style.width = '100%';
        } else {
            width += 2;
            progressLine.style.width = width + '%';
        }
    }, 50);
}

increaseLoaderProgress();

window.addEventListener('load', () => {
    setTimeout(() => {
        progressLine.style.width = '100%';
        clearInterval(progressInterval);
        setTimeout(() => {
            loader.classList.add('is--loaded');
            // AUTO-START: сразу показываем колесо без кнопки "Играть"
            document.getElementById('game').classList.add('is--started');
        }, 800);
    }, 600);
});

// Init game
document.addEventListener('DOMContentLoaded', () => {
    const game = new IceFishingGame();
    game.init();
    // Сразу активируем кнопку спина (без ожидания клика на "Играть")
    document.getElementById('spin-btn').addEventListener('click', () => game.spin());
});

// =====================================================
// ЗАЩИТА КОНТЕНТА
// =====================================================
document.addEventListener('contextmenu', e => e.preventDefault());
document.addEventListener('selectstart', e => e.preventDefault());
document.addEventListener('dragstart', e => e.preventDefault());
document.addEventListener('keydown', e => {
    if (e.key === 'F12' || 
        (e.ctrlKey && e.shiftKey && ['I','J','C','i','j','c'].includes(e.key)) ||
        (e.ctrlKey && ['U','u','S','s'].includes(e.key))) {
        e.preventDefault();
        return false;
    }
});
document.querySelectorAll('img').forEach(img => {
    img.setAttribute('draggable', 'false');
    img.style.pointerEvents = 'none';
});
</script>
</body>
</html>
